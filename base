# to build a CentOS6 with GCC, GDB and python27
FROM centos:centos6
MAINTAINER Yiting Huang <hyt1981@gmail.com>

RUN mkdir -p /root/install
WORKDIR /root/install

RUN yum -y install gcc gdb python
RUN yum -y install wget tar

# build python27
RUN yum -y install zlib-devel readline-devel ncurses-devel openssl-devel gdbm-devel sqlite-devel bzip2-devel
RUN wget https://www.python.org/ftp/python/2.7.8/Python-2.7.8.tgz && \
  tar -zxvf Python-2.7.8.tgz && \
  cd Python-2.7.8 && \
  ./configure --prefix=/opt/python27 --with-doc-strings --enable-shared && \
  make && \
  make install && \
  echo "/opt/python27/lib/" > /etc/ld.so.conf.d/python27.conf && \
  ldconfig && \
  cd .. && \
  rm -rf Python-2.7.8 && \
  rm -f Python-2.7.8.tgz

# prepare pip and setuptools for both python26 and python27
RUN mkdir -p /root/.pip && \
  echo '[global]' > /root/.pip/pip.conf && \
  echo 'index-url = http://pypi.douban.com/simple' >> /root/.pip/pip.conf
RUN wget https://bootstrap.pypa.io/get-pip.py && \
  python get-pip.py && \
  /opt/python27/bin/python get-pip.py && \
  rm -f get-pip.py
WORKDIR /root
RUN pip install virtualenv && mkdir pyenv26
RUN /opt/python27/bin/pip install virtualenv && mkdir pyenv27
